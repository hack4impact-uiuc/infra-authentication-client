{"version":3,"file":"static/webpack/static/development/pages/login.js.d8cc9384ee552e5ff451.hot-update.js","sources":["webpack:///./pages/login.js"],"sourcesContent":["import API_URL from \"../components/globalApiUrl.js\";\nimport Link from \"next/link\";\nimport Router from \"next/router\";\nimport Layout from \"../components/layout.js\";\n\nexport default class extends React.Component {\n  state = { email: \"\", password: \"\", loggingIn: false, errorMessage: \"\" };\n\n  handleChange = event => {\n    const value = event.target.value,\n      name = event.target.name;\n    this.setState({ [name]: value });\n  };\n\n  handleSubmit = event => {\n    event.preventDefault();\n\n    if (!this.state.loggingIn) {\n      this.setState({ loggingIn: true, errorMessage: \"\" });\n\n      fetch(API_URL + \"/auth\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          email: this.state.email,\n          password: this.state.password\n        })\n      })\n        .then(r => r.json())\n        .then(resp => {\n          /* returns a JSON object {result: \"success\"} or {error:\"\"} with 400 status */\n          if (!resp.result) {\n            this.setState({ errorMessage: \"Email or Password is invalid.\" });\n          } else {\n            document.cookie = \"authtoken=\" + resp.token;\n            console.log(resp.token);\n            window.location = \"/secret\";\n          }\n\n          this.setState({ loggingIn: false });\n        });\n    }\n  };\n\n  render = () => (\n    <Layout>\n      <div>\n        <h2>Login</h2>\n\n        <form onSubmit={this.handleSubmit}>\n          {this.state.errorMessage}\n\n          <input\n            name=\"email\"\n            type=\"email\"\n            placeholder=\"Email Address\"\n            value={this.state.email}\n            onChange={this.handleChange}\n            required\n          />\n          <input\n            name=\"password\"\n            type=\"password\"\n            placeholder=\"password\"\n            value={this.state.password}\n            onChange={this.handleChange}\n            required\n          />\n          <button name=\"submit\" type=\"submit\">\n            {this.state.loggingIn ? \"Logging in..\" : \"Log In\"}\n          </button>\n        </form>\n      </div>\n    </Layout>\n  );\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAFA;AAHA;AAQA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAKA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AAAA;AAAA;AAxBA;AACA;;;;;AAxCA;AACA;;;;;A","sourceRoot":""}